<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>User Dashboard | Community Fund</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f4f8;
            margin: 0;
            padding: 0;
        }

        header {
            text-align: center;
            padding: 2rem;
            background-color: #27ae60;
            color: white;
        }

        nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 1rem 0;
        }

        nav button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #1cc88a;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }

        nav button.active {
            background-color: #17a673;
        }

        section {
            max-width: 800px;
            margin: 2rem auto;
            display: none;
        }

        section.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
        }

        h2 {
            margin-top: 0;
            color: #2c3e50;
        }

        .btn {
            background-color: #27ae60;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #2ecc71;
        }

        .progress-container {
            background: #e0e0e0;
            border-radius: 25px;
            overflow: hidden;
            height: 25px;
            margin: 1rem 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            text-align: right;
            padding-right: 10px;
            line-height: 25px;
            color: white;
            font-weight: bold;
            border-radius: 25px;
            transition: width 1s ease-in-out;
        }

        .donate-section {
            margin-top: 1rem;
        }

        .donate-input {
            width: 100px;
            padding: 5px;
            margin-right: 10px;
        }

        .impact {
            margin-top: 1rem;
            font-style: italic;
            color: #16a085;
        }

        .hidden {
            display: none;
        }

        #notification {
            position: fixed;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: #27ae60;
            color: white;
            padding: 15px 30px;
            border-radius: 0 0 8px 8px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: top 0.5s ease;
            z-index: 1000;
        }

        #notification.show {
            top: 0;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal {
            background: #fff;
            padding: 2rem;
            border-radius: 10px;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.3s ease;
        }

        .modal h3 {
            margin-top: 0;
            color: #2c3e50;
        }

        .modal button {
            margin: 0.5rem;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .modal .donate-btn {
            background: #27ae60;
            color: white;
        }

        .modal .cancel-btn {
            background: #e74c3c;
            color: white;
        }

        @keyframes fadeIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>üå± Community Fund Dashboard</h1>
    </header>

    <!-- Tabs -->
    <nav>
        <button class="tab-btn active" data-tab="view">View Projects</button>
        <button class="tab-btn" data-tab="donate">Donate</button>
        <button class="tab-btn" data-tab="status">Status Update</button>
    </nav>

    <!-- Notification -->
    <div id="notification"></div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal" id="modal">
            <h3>Extra Donation Available üéÅ</h3>
            <p id="modal-text"></p>
            <div id="modal-buttons"></div>
            <button class="cancel-btn" onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <!-- Tabs Content -->
    <section id="view" class="active">
        <div class="card">
            <h2>School Garden</h2>
            <p>Plant 50 saplings at the community school.</p>
        </div>
        <div class="card">
            <h2>Neighborhood Cleanup</h2>
            <p>Clean and repaint the local park.</p>
        </div>
        <div class="card">
            <h2>Library Upgrade</h2>
            <p>Add new books and seating in library.</p>
        </div>
    </section>

    <section id="donate">
        <!-- Donate tab: Your full donation logic -->
    </section>

    <section id="status">
        <p>Status updates will appear here.</p>
    </section>

    <script>
        // Tab functionality
        const tabButtons = document.querySelectorAll(".tab-btn");
        const sections = document.querySelectorAll("section");

        tabButtons.forEach(btn => {
            btn.addEventListener("click", () => {
                tabButtons.forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                sections.forEach(sec => sec.classList.remove("active"));
                document.getElementById(btn.dataset.tab).classList.add("active");
            });
        });

        // === DONATE TAB LOGIC START ===
        const donateSection = document.getElementById("donate");

        const projects = [
            { id: 1, title: "School Garden", description: "Plant 50 saplings at the community school.", target: 1000, raised: 250 },
            { id: 2, title: "Neighborhood Cleanup", description: "Clean and repaint the local park.", target: 2000, raised: 750 },
            { id: 3, title: "Library Upgrade", description: "Add new books and seating in library.", target: 1500, raised: 600 }
        ];

        const notification = document.getElementById("notification");
        const modalOverlay = document.getElementById("modal-overlay");
        const modalText = document.getElementById("modal-text");
        const modalButtons = document.getElementById("modal-buttons");

        function showNotification(message, color = "#27ae60") {
            notification.textContent = message;
            notification.style.background = color;
            notification.classList.add("show");
            setTimeout(() => notification.classList.remove("show"), 3000);
        }

        function openModal(leftover, fromProject) {
            modalText.textContent = `You still have ‚Çπ${leftover} left. Would you like to donate it to another project?`;
            modalButtons.innerHTML = "";

            projects.filter(p => p.id !== fromProject.id).forEach(p => {
                if (p.raised < p.target) {
                    const btn = document.createElement("button");
                    btn.classList.add("donate-btn");
                    btn.textContent = p.title;
                    btn.onclick = () => {
                        p.raised = Math.min(p.raised + leftover, p.target);
                        updateProgress(p.id);
                        closeModal();
                        showNotification(`‚úÖ Added ‚Çπ${leftover} to "${p.title}". Thank you again!`);
                    };
                    modalButtons.appendChild(btn);
                }
            });

            modalOverlay.style.display = "flex";
        }

        function closeModal() {
            modalOverlay.style.display = "none";
        }

        function updateProgress(id) {
            const project = projects.find(p => p.id === id);
            const progressBar = document.getElementById(`progress-bar-${id}`);
            const impactText = document.getElementById(`impact-text-${id}`);

            const percent = Math.min((project.raised / project.target) * 100, 100).toFixed(0);
            progressBar.style.width = percent + "%";
            progressBar.textContent = percent + "%";

            if (percent >= 100) {
                impactText.textContent = "üéâ Goal achieved! Thank you!";
            } else if (percent >= 50) {
                impactText.textContent = "üíö More than halfway there!";
            } else {
                impactText.textContent = "üå± Every contribution counts!";
            }
        }

        // Render donation cards in Donate tab
        projects.forEach(project => {
            const card = document.createElement("div");
            card.classList.add("card");
            card.innerHTML = `
            <h2>${project.title}</h2>
            <button class="btn" id="view-btn-${project.id}">View / Donate</button>
            <div class="details hidden" id="details-${project.id}">
              <p>${project.description}</p>
              <div class="progress-container">
                <div class="progress-bar" id="progress-bar-${project.id}">0%</div>
              </div>
              <div class="donate-section">
                <input type="number" id="donation-${project.id}" class="donate-input" placeholder="‚Çπ">
                <button class="btn" id="donate-btn-${project.id}">Donate</button>
              </div>
              <p class="impact" id="impact-text-${project.id}"></p>
            </div>
          `;
            donateSection.appendChild(card);
            updateProgress(project.id);

            document.getElementById(`view-btn-${project.id}`).addEventListener("click", () => {
                document.getElementById(`details-${project.id}`).classList.toggle("hidden");
            });

            document.getElementById(`donate-btn-${project.id}`).addEventListener("click", () => {
                if (project.raised >= project.target) {
                    showNotification("This project is already complete üéâ", "#e74c3c");
                    return;
                }

                const donationInput = document.getElementById(`donation-${project.id}`);
                const donationAmount = parseInt(donationInput.value) || 0;

                if (donationAmount > 0) {
                    const remaining = project.target - project.raised;

                    if (donationAmount >= remaining) {
                        project.raised = project.target;
                        updateProgress(project.id);
                        donationInput.value = "";
                        const leftover = donationAmount - remaining;
                        showNotification(`üéâ You completed "${project.title}"!`);

                        if (leftover > 0) {
                            openModal(leftover, project);
                        }

                    } else {
                        project.raised += donationAmount;
                        updateProgress(project.id);
                        donationInput.value = "";
                        showNotification(`Thank you for donating ‚Çπ${donationAmount}!`);
                    }
                } else {
                    showNotification("Please enter a valid donation.", "#e74c3c");
                }
            });
        });
        // === DONATE TAB LOGIC END ===
    </script>
</body>

</html>
